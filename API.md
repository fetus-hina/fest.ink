fest.ink API
============

fest.inkと同等のサイトを構築できるであろうAPIを公開しています。

ご自由にお使いいただけますが、次の点にご留意ください。

* APIの仕様は突然変更になる（互換性が失われる）可能性があります。フェス中には変更しません。
* APIはfest.ink用に作成/使用しているものをそのまま流用しています。
    - このAPIの目的はあくまでfest.ink用が第一です。負荷状況等に応じて遮断する可能性があります。
    - このAPIにクライアントのブラウザから直接アクセスするのは避けてください。
        - ある程度キャッシュすることで負荷軽減にご協力ください。データはそれほど頻繁には更新されません。
        - 現在のところ `Access-Control-Allow-Origin` の設定など、CORSに対応する設定を行うことは考えていません。

日時型は、UNIX時間を秒精度で整数型に格納して表します。ほとんどのプログラミング言語ではUNIX時間を取り扱えるはずです。
JavaScriptで取り扱う場合は、1000倍してください。（例：`new Date(at * 1000)`、JavaScriptではミリ秒単位のため）


## GET /index.json ##

[`GET https://fest.ink/index.json`](https://fest.ink/index.json)

フェスに関する情報と提供元サイトに関する情報を返します。

```js
{
  "now":1441531963.1234, // 取得日時（サーバ時間）, UNIX時間で秒単位
  "source":{
    "name":"イカフェスレート",
    "url":"https://fest.ink/",
    "version":"1.9.0-alpha9",
    "revision":["4c92cd09b91df8f4f5dbcb185f6b3fb5860188f6","4c92cd0"] // Gitリビジョン
  },
  "fests":[
    {
      "id":5, // 第n回と一致します
      "name":"ボケ vs ツッコミ",
      "term":{
        "begin":1442026800, // フェスの開始日時
        "end":1442113200,   // フェスの終了日時（この直前まで）
        "in_session":false  // フェス中ならtrue
      },
      "teams":{
        "alpha":{ // アオリチーム
          "name":"ボケ",
          "ink":"d9612b" // インク色（適当にそれっぽく設定したもの）
        },
        "bravo":{ // ホタルチーム
          "name":"ツッコミ",
          "ink":"5c7cb8"
        }
      }
    },
    // ...
  ]
}
```

要素の出現順は一致しない可能性があります。また、フェスは開催順でない場合があり得るものと想定してください。（現在の実装上は新しいものから並びます）


## GET /:id.json ##

[`GET https://fest.ink/:id.json`](https://fest.ink/4.json)

指定されたフェスの情報を返します。サンプリングされた勝ち数も含まれます。（fest.inkのフェスページに表示される内容はこのJSONから全て求められます）

```js
{
  "now":1441531963.1234, // 取得日時（サーバ時間）, UNIX時間で秒単位
  "id":4,
  "name":"キリギリス vs アリ",
  "term":{
    "begin":1440212400,
    "end":1440298800,
    "in_session":false
  },
  "teams":{
    "alpha":{
      "name":"キリギリス",
      "ink":"5bcc3d"
    },
    "bravo":{
      "name":"アリ",
      "ink":"bf60b8"
    }
  },
  "wins":[ // 各タイミングでの各チームの勝利数（サンプリング済み）
    {
      "at":1440212637, // 2015-08-22 12:03:57 JST に取得したデータでは
      "alpha":51, // チームA(キリギリス)は51勝
      "bravo":40  // チームB(アリ)は40勝
      // 2つのチームの合計は概ね100に近い数字になるようですが、
      // 変動幅も含めて任天堂次第なので謎です
    },
    //...
  ]
}
```

要素の出現順は一致しない可能性があります。また、`wins`配列の中身は順不同と想定してください。（時系列で何かしたければ`at`を使用して並び替えてください）
