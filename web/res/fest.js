!function(t,e){"use strict";var r=t.jQuery,n=Number.NaN;r(t.document).ready(function(){var a=r(".container[data-fest]").attr("data-fest");if((a+"").match(/^\d+$/)){var i=r(".total-rate"),o=r(".total-progressbar"),s=r(".rate-graph");if(!(i.length<1&&o.length<1&&s.length<1)){var c=function(){var t=function(t){for(var e=0,r=0,a=0;a<t.wins.length;++a)e+=t.wins[a].r,r+=t.wins[a].g;var i=e+r;return{r:i>0?e/i:n,g:i>0?r/i:n}},c=function(t){i.each(function(){var a=r(this),i=function(){switch(a.attr("data-team")){case"red":return t.r;case"green":return t.g;default:return n}}();a.text(i===e||isNaN(i)?"???":Math.round(1e3*i)/10+"%")})},u=function(t){o.each(function(){var a=r(this),i=function(){switch(a.attr("data-team")){case"red":return t.r;case"green":return t.g;default:return n}}();a.width(i===e||isNaN(i)?"0%":100*i+"%")})},f=function(t){return{series:{stack:!0,lines:{show:!0,fill:!0,steps:!1}},xaxis:{mode:"time",minTickSize:[30,"minute"],timeformat:"%H:%M",twelveHourClock:!1,timezone:"browser",min:1e3*t.begin,max:1e3*t.end},yaxis:{min:0,max:100},colors:["#d9435f","#5cb85c"]}},h=function(t){var e=s.filter(".rate-graph-short");if(e.length>0){for(var n=[],a=[],i=0;i<t.wins.length;++i){var o=t.wins[i];o.r+o.g>0&&(n.push([1e3*o.at,100*o.r/(o.r+o.g)]),a.push([1e3*o.at,100*o.g/(o.r+o.g)]))}e.each(function(){var e=r(this);e.empty(),r.plot(e,[n,a],f(t.term))})}},l=function(t){var e=s.filter(".rate-graph-whole");if(e.length>0){var n=t.wins.slice(0);n.sort(function(t,e){return t.at-e.at});for(var a=0,i=0,o=[],c=[],u=0;u<n.length;++u){var h=n[u];a+=h.r,i+=h.g,a+i>0&&(o.push([1e3*h.at,100*a/(a+i)]),c.push([1e3*h.at,100*i/(a+i)]))}e.each(function(){var e=r(this);e.empty(),r.plot(e,[o,c],f(t.term))})}};r.getJSON("/"+encodeURIComponent(a)+".json",{_t:Math.floor(new Date/1e3)},function(e){var r=t(e);c(r),u(r),h(e),l(e)})};t.setTimeout(function(){c.call(t),t.setInterval(function(){c.call(t)},6e5)},1)}}})}(window);